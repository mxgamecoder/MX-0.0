<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>üìû Support | LUMORA ID</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="icon" href="lumora.png" type="image/png">
<style>
  body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background: #000;
    color: #fff;
    display: flex;
    justify-content: center;
    align-items: flex-start;
    padding-top: 120px;
    min-height: 100vh;
  }

  .container {
    background: #000;
    padding: 30px 25px;
    border-radius: 12px;
    max-width: 480px;
    width: 100%;
    text-align: center;
  }

  h1 {
    color: #9F7AEA;
    font-size: 1.9rem;
    margin-bottom: 10px;
  }

  p {
    color: #fff;
    font-size: 0.95rem;
    margin-bottom: 25px;
  }

  /* Purple border wrapper */
  .form-box {
    border: 2px solid #9F7AEA;
    border-radius: 12px;
    padding: 20px;
    display: flex;
    flex-direction: column;
    gap: 15px;
    align-items: stretch;
    text-align: left;
  }

  input[type="text"], 
  input[type="email"], 
  textarea, 
  input[type="file"] {
    width: 100%;
    padding: 12px 14px;
    border-radius: 8px;
    border: 1px solid #9F7AEA;
    background: #000;
    color: #fff;
    font-size: 1rem;
    box-sizing: border-box;
  }

  input::placeholder, textarea::placeholder {
    color: #9F7AEA;
  }

  small {
    color: #9F7AEA;
    font-size: 0.85rem;
    margin-top: -5px;
  }

  button {
    width: 100%;
    padding: 14px;
    background: #9F7AEA;
    border: none;
    border-radius: 10px;
    color: #fff;
    font-weight: 600;
    font-size: 1rem;
    cursor: pointer;
    transition: 0.3s;
    margin-top: 20px; /* separates button from border box */
  }

  button:hover:enabled {
    background: #7C5AD9;
  }

  button:disabled {
    opacity: 0.7;
    cursor: not-allowed;
  }

  /* Toast Centered */
  .toast {
    position: fixed;
    top: 50px;
    left: 50%;
    transform: translateX(-50%);
    background: #9F7AEA;
    padding: 14px 20px;
    border-radius: 10px;
    display: none;
    z-index: 999;
    font-weight: bold;
    text-align: center;
    min-width: 250px;
  }

  .toast.show {
    display: block;
    animation: fadeInOut 4s ease;
  }

  @keyframes fadeInOut {
    0% { opacity: 0; transform: translate(-50%, -20px); }
    10% { opacity: 1; transform: translate(-50%, 0); }
    90% { opacity: 1; transform: translate(-50%, 0); }
    100% { opacity: 0; transform: translate(-50%, -20px); }
  }

  /* Modal */
  .modal {
    position: fixed;
    inset: 0;
    background: rgba(0,0,0,0.8);
    display: none;
    justify-content: center;
    align-items: center;
    z-index: 998;
  }

  .modal-content {
    background: #000;
    padding: 25px;
    border-radius: 12px;
    max-width: 400px;
    width: 90%;
    text-align: center;
  }

  .modal-content h2 {
    color: #9F7AEA;
    margin-bottom: 12px;
    font-size: 1.4rem;
  }

  .modal-content p {
    color: #fff;
    font-size: 0.95rem;
    margin-bottom: 20px;
  }

  .modal-content button {
    width: 60%;
    background: #9F7AEA;
    border: none;
    border-radius: 10px;
    color: #fff;
    padding: 12px;
    cursor: pointer;
  }

  .modal-content button:hover {
    background: #7C5AD9;
  }

  @media(max-width: 500px){
    body { padding-top: 80px; }
    h1 { font-size: 1.6rem; }
  }
</style>
</head>
<body>

<div class="container">
  <h1>üìû Contact Support</h1>
  <p>Tell us what‚Äôs wrong or what you need help with. We'll respond as quickly as possible üí¨</p>

  <form id="guestSupportForm">
    <div class="form-box">
      <input type="text" id="fullname" placeholder="Full Name" required>
      <input type="email" id="email" placeholder="Email" required>
      <textarea id="message" placeholder="Describe your issue..." rows="5" required></textarea>
      <small>Max 5 files. Allowed formats: JPG, PNG, PDF</small>
      <input type="file" id="attachments" multiple accept=".jpg,.jpeg,.png,.pdf">
    </div>
    <button type="submit">üì§ Submit Request</button>
  </form>
</div>

<div id="toast" class="toast"></div>

<div id="modal" class="modal">
  <div class="modal-content">
    <h2>‚úÖ Request Sent!</h2>
    <p>Check your email inbox or spam for confirmation.</p>
    <button onclick="closeModal()">Close</button>
  </div>
</div>

<script>
function showToast(msg){
  const toast = document.getElementById('toast');
  toast.textContent = msg;
  toast.classList.add('show');
  setTimeout(()=> toast.classList.remove('show'), 4000);
}

function openModal(){ document.getElementById('modal').style.display='flex'; }
function closeModal(){ document.getElementById('modal').style.display='none'; }

document.getElementById('guestSupportForm').addEventListener('submit', async (e)=>{
  e.preventDefault();
  const btn = e.target.querySelector('button');
  btn.disabled = true;
  btn.textContent = '‚è≥ Submitting...';

  const fullname = document.getElementById('fullname').value.trim();
  const email = document.getElementById('email').value.trim();
  const message = document.getElementById('message').value.trim();
  const files = document.getElementById('attachments').files;

  if(files.length > 5){
    showToast('‚ùå Max 5 files allowed');
    btn.disabled = false;
    btn.textContent = 'üì§ Submit Request';
    return;
  }

  const formData = new FormData();
  formData.append('fullname', fullname);
  formData.append('email', email);
  formData.append('message', message);
  for(let i=0;i<files.length;i++) formData.append('attachments', files[i]);

  try{
    const res = await fetch('https://mxapi-lnc.onrender.com/api/support/guest', { method:'POST', body: formData });
    const data = await res.json();
    if(data.success){
      showToast('‚úÖ Ticket created!');
      document.getElementById('guestSupportForm').reset();
      openModal();
    } else {
      showToast('‚ùå ' + (data.msg || 'Something went wrong'));
    }
  }catch(err){
    showToast('‚ùå ' + err.message);
    console.error(err);
  } finally {
    btn.disabled = false;
    btn.textContent = 'üì§ Submit Request';
  }
});
</script>

</body>
</html>
